{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/login.js","public/js/updateSettings.js","public/js/stripe.js","public/js/index.js"],"sourcesContent":["/* es-lint-disable */\nexport const displayMap = (locations) => {\n  mapboxgl.accessToken =\n    \"pk.eyJ1IjoiY2hyaXN0YWxsIiwiYSI6ImNsMzhhOHk0dTA1amYzY2pqcGNtenY1cGMifQ.T2PyKEVPVvWNkDhoYbF_vA\";\n\n  var map = new mapboxgl.Map({\n    container: \"map\",\n    style: \"mapbox://styles/christall/cl38b5ruz000z14pl2ov6kuyw\",\n    scrollZoom: false,\n    // center: [-118.111779, 34.111677],\n    // zoom: 10,\n    // interactive: false,\n  });\n\n  const bounds = new mapboxgl.LngLatBounds();\n\n  locations.forEach((loc) => {\n    // Add marker\n    const el = document.createElement(\"div\");\n    el.className = \"marker\";\n\n    new mapboxgl.Marker({\n      element: el,\n      anchor: \"bottom\",\n    })\n      .setLngLat(loc.coordinates)\n      .addTo(map);\n\n    // Add popup\n    new mapboxgl.Popup({\n      offset: 30,\n    })\n      .setLngLat(loc.coordinates)\n      .setHTML(`<p>Day ${loc.description}</p>`)\n      .addTo(map);\n\n    // Extends the map bounds to include current location\n    bounds.extend(loc.coordinates);\n  });\n\n  map.fitBounds(bounds, {\n    padding: {\n      top: 200,\n      bottom: 150,\n      left: 100,\n      right: 100,\n    },\n  });\n};\n","/* es-lint-disable */\nexport const hideAlert = () => {\n  const el = document.querySelector(\".alert\");\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is \"success\" or \"error\"\nexport const showAlert = (type, msg) => {\n  hideAlert();\n\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector(\"body\").insertAdjacentHTML(\"afterbegin\", markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","import axios from \"axios\";\nimport { showAlert } from \"./alerts\";\n\nexport const login = async (email, password) => {\n  // console.log(email, password);\n\n  try {\n    /* es-lint-disable */\n    const res = await axios({\n      method: \"POST\",\n      url: \"/api/v1/users/login\",\n      data: {\n        email,\n        password,\n      },\n    });\n\n    if (res.data.status === \"success\") {\n      showAlert(\"success\", \"Logged in successfully!\");\n      window.setTimeout(() => {\n        location.assign(\"/\");\n      }, 1500);\n    }\n  } catch (err) {\n    showAlert(\"error\", err.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: \"GET\",\n      url: \"/api/v1/users/logout\",\n    });\n    if (res.data.status === \"success\") location.reload(true);\n  } catch (err) {\n    console.log(err.response);\n    showAlert(\"error\", \"Error logging out! Try again.\");\n  }\n};\n","/* es-lint-disable */\nimport axios from \"axios\";\nimport { showAlert } from \"./alerts\";\n\n// tyoe is either \"password\" or \"data\"\nexport const updateSettings = async (data, type) => {\n  try {\n    const url =\n      type === \"password\"\n        ? \"/api/v1/users/updateMyPassword\"\n        : \"/api/v1/users/updateMe\";\n\n    const res = await axios({\n      method: \"PATCH\",\n      url,\n      data,\n    });\n\n    if (res.data.status === \"success\") {\n      showAlert(\"success\", `${type.toUpperCase()} updated successfully!`);\n    }\n  } catch (err) {\n    showAlert(\"error\", err.response.data.message);\n  }\n};\n","/* es-lint-disable */\nimport axios from \"axios\";\nimport { showAlert } from \"./alerts\";\nconst stripe = Stripe(\n  \"pk_test_51L8HWmH8wDrQ157NszA5odkWNjJLl0djWNCNg3cAxJNLaLLkuHyJ9mOYljkI41THGTg5Xb8a3C2XwoLWXeuKylb000T7ezNi82\"\n);\n\nexport const bookTour = async (tourId) => {\n  try {\n    // 1) Get checkout session from endpoint (API)\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n    // console.log(session);\n\n    // 2) Create checkout form + charge credit card\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n  } catch (err) {\n    console.log(err);\n    showAlert(\"error\", err);\n  }\n};\n","/* es-lint-disable */\nimport \"@babel/polyfill\";\nimport { displayMap } from \"./mapbox\";\nimport { login, logout } from \"./login\";\nimport { updateSettings } from \"./updateSettings\";\nimport { bookTour } from \"./stripe\";\n\n// DOM ELEMENTS\nconst mapBox = document.getElementById(\"map\");\nconst loginForm = document.querySelector(\".form\");\nconst logOutBtn = document.querySelector(\".nav__el--logout\");\nconst userDataForm = document.querySelector(\".form-user-data\");\nconst userPasswordForm = document.querySelector(\".form-user-password\");\nconst bookBtn = document.getElementById(\"book-tour\");\n\n// DELEGATION\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm) {\n  loginForm.addEventListener(\"submit\", (e) => {\n    e.preventDefault();\n    const email = document.getElementById(\"email\").value;\n    const password = document.getElementById(\"password\").value;\n    login(email, password);\n  });\n}\n\nif (logOutBtn) logOutBtn.addEventListener(\"click\", logout);\n\nif (userDataForm) {\n  userDataForm.addEventListener(\"submit\", (e) => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append(\"name\", document.getElementById(\"name\").value);\n    form.append(\"email\", document.getElementById(\"email\").value);\n    form.append(\"photo\", document.getElementById(\"photo\").files[0]);\n    console.log(form);\n    updateSettings(form, \"data\");\n  });\n}\n\nif (userPasswordForm) {\n  userPasswordForm.addEventListener(\"submit\", async (e) => {\n    e.preventDefault();\n    document.querySelector(\".btn-save-password\").textContent = \"Updating...\";\n\n    const passwordCurrent = document.getElementById(\"password-current\").value;\n    const password = document.getElementById(\"password\").value;\n    const passwordConfirm = document.getElementById(\"password-confirm\").value;\n    await updateSettings(\n      { passwordCurrent, password, passwordConfirm },\n      \"password\"\n    );\n\n    document.querySelector(\".btn-save-password\").textContent = \"Save password\";\n    document.getElementById(\"password-current\").value = \"\";\n    document.getElementById(\"password-\").value = \"\";\n    document.getElementById(\"password-confirm\").value = \"\";\n  });\n}\n\nif (bookBtn)\n  bookBtn.addEventListener(\"click\", (e) => {\n    e.target.textContent = \"Processing...\";\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n"],"names":["$3c4e158d14605c12$export$4c5dd147b21b9176","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","loc","el","document","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","description","extend","fitBounds","padding","top","bottom","left","right","$7dc87b7f457e655a$export$516836c6a9dfc573","querySelector","parentElement","removeChild","$7dc87b7f457e655a$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$bf5b431e6a69fea8$export$596d806903d1f59e","async","email","password","$parcel$interopDefault","$cnf0l$axios","method","url","data","status","location","assign","err","response","message","$955535ce7513e32c$export$f558026a994b6051","toUpperCase","$9fd71c92b6f885af$var$stripe","Stripe","$9fd71c92b6f885af$export$8d5bdbf26681c0c2","tourId","session","redirectToCheckout","sessionId","id","console","log","$407eccdc61ba7a94$var$mapBox","getElementById","$407eccdc61ba7a94$var$loginForm","$407eccdc61ba7a94$var$logOutBtn","$407eccdc61ba7a94$var$userDataForm","$407eccdc61ba7a94$var$userPasswordForm","$407eccdc61ba7a94$var$bookBtn","JSON","parse","dataset","addEventListener","e","preventDefault","value","reload","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","target"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}